# 配置文件说明

## 配置文件概述

本系统使用INI格式的配置文件，所有配置文件都存放在 `config/` 目录下。

## 配置文件列表

### 1. mysql.ini - 数据库配置

**用途**: 配置数据库连接参数

**配置方法一**: 直接编辑文件
```ini
[database]
host = 127.0.0.1          # 数据库服务器地址
user = root               # 数据库用户名  
password = "123456"       # 数据库密码
database = fcbmwos        # 数据库名称
port = 12345             # 数据库端口
charset = utf8           # 字符集

[connection]
timeout = 30             # 连接超时时间（秒）
persistent = false       # 是否启用持久连接
max_connections = 100    # 最大连接数
```

**配置方法二**: 使用环境变量
```bash
export DB_HOST=127.0.0.1
export DB_USER=root
export DB_PASSWORD=123456
export DB_NAME=fcbmwos
export DB_PORT=3306
```

**配置方法三**: 通过API动态配置
```bash
# 暂不支持，未来版本可能添加
```

### 2. app-config.ini - 应用配置

**用途**: 配置应用程序状态和设置

**配置方法一**: 手动编辑
```ini
[database]
; 数据库是否已初始化 (true/false)
initialized = false

[system]
; 系统版本
version = 1.0.0
; 调试模式
debug = false
; 日志级别
log_level = info
```

**配置方法二**: 通过API配置
```bash
# 获取配置
curl "http://localhost:8000/api/config-manager.php?key=database.initialized"

# 设置配置
curl -X POST http://localhost:8000/api/config-manager.php \
  -H "Content-Type: application/json" \
  -d '{"key":"database.initialized","value":"true"}'
```

**配置方法三**: 通过Web界面配置
- 访问数据库初始化页面会自动更新 `database.initialized` 状态

## 配置参数详解

### 数据库配置参数

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| host | string | 127.0.0.1 | 数据库服务器地址 |
| user | string | root | 数据库用户名 |
| password | string | - | 数据库密码（建议加引号） |
| database | string | fcbmwos | 数据库名称 |
| port | integer | 3306 | 数据库端口 |
| charset | string | utf8 | 字符编码 |
| timeout | integer | 30 | 连接超时时间 |
| persistent | boolean | false | 持久连接 |
| max_connections | integer | 100 | 最大连接数 |

### 应用配置参数

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| initialized | boolean | false | 数据库初始化状态 |
| version | string | 1.0.0 | 系统版本号 |
| debug | boolean | false | 调试模式开关 |
| log_level | string | info | 日志记录级别 |

## 配置最佳实践

### 方法一: 开发环境配置

1. **使用本地数据库**
   ```ini
   [database]
   host = 127.0.0.1
   user = root
   password = "123456"
   database = fcbmwos_dev
   port = 3306
   ```

2. **启用调试模式**
   ```ini
   [system]
   debug = true
   log_level = debug
   ```

### 方法二: 生产环境配置

1. **使用远程数据库**
   ```ini
   [database]
   host = 192.168.1.100
   user = fcbmwos_user
   password = "complex_password_123!"
   database = fcbmwos_prod
   port = 3306
   charset = utf8mb4
   ```

2. **优化连接参数**
   ```ini
   [connection]
   timeout = 10
   persistent = true
   max_connections = 50
   ```

3. **关闭调试模式**
   ```ini
   [system]
   debug = false
   log_level = error
   ```

### 方法三: 测试环境配置

1. **使用测试数据库**
   ```ini
   [database]
   host = test.example.com
   user = test_user
   password = "test_password"
   database = fcbmwos_test
   port = 3306
   ```

2. **适中的日志级别**
   ```ini
   [system]
   debug = false
   log_level = warning
   ```

## 配置文件安全

### 方法一: 文件权限控制

```bash
# 设置配置文件权限
chmod 600 config/*.ini
chown www-data:www-data config/*.ini
```

### 方法二: 敏感信息加密

```bash
# 使用环境变量存储敏感信息
export DB_PASSWORD=$(echo "123456" | base64)
```

### 方法三: 配置文件备份

```bash
# 定期备份配置文件
cp config/mysql.ini config/mysql.ini.backup.$(date +%Y%m%d)
```

## 故障排除

### 配置文件不存在

**问题**: 系统提示配置文件不存在

**解决方法一**: 检查文件路径
```bash
ls -la config/
```

**解决方法二**: 重新创建配置文件
```bash
cp config/mysql.ini.example config/mysql.ini
```

**解决方法三**: 使用系统自动创建功能
- 访问系统页面，会自动创建默认配置文件

### 配置参数错误

**问题**: 数据库连接失败

**解决方法一**: 验证配置参数
```bash
# 测试数据库连接
mysql -h 127.0.0.1 -u root -p fcbmwos
```

**解决方法二**: 检查配置文件格式
```bash
# 验证INI文件格式
php -r "print_r(parse_ini_file('config/mysql.ini', true));"
```

**解决方法三**: 查看错误日志
```bash
# 检查PHP错误日志
tail -f /var/log/php_errors.log
```

## 配置更新

### 方法一: 在线更新

通过Web界面或API更新配置，系统会自动重新加载配置。

### 方法二: 离线更新

直接编辑配置文件后，需要重启Web服务器或清除缓存。

### 方法三: 批量更新

使用脚本批量更新多个配置参数。

---

**注意**: 修改配置文件后，建议重启Web服务器以确保配置生效。